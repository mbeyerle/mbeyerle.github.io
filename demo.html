<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tibi Color Wheel (08/15 2244)</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      background: black;
      color: white;
      font-family: sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    svg {
      display: block;
    }
    .label {
      font-size: 14px;
      fill: white;
    }
    .leader {
      stroke: white;
      stroke-width: 1px;
    }
  </style>
</head>
<body>
<svg id="wheel" width="800" height="800"></svg>
<script>
// === CONFIG ===
const width = 800, height = 800;
const svg = d3.select("#wheel")
    .attr("width", width)
    .attr("height", height);
const g = svg.append("g")
    .attr("transform", `translate(${width/2},${height/2})`);

const radii = [50, 130, 230, 300]; // inner/outer radii for rings
const thicknesses = [50, 80, 100, 70]; // Ring 4 thinner

// === COLORS (sampled from your reference image) ===
// Ring 1: solid black
const ring1Colors = ["#000000"];

// Ring 2: 8 colors
const ring2Colors = [
  "#0C111C","#756364","#B5ABA7","#A0696E",
  "#802E1E","#746D66","#434343","#6A4A22"
];

// Ring 3: 17 colors
const ring3Colors = [
  "#537981","#76907E","#8E8C68","#A9894C","#D89E56",
  "#E9B589","#F7CE97","#FCE3B7","#FFECCA","#F6F1E2",
  "#CBD9C2","#9CC7AC","#5E9D82","#3B7C63","#356159",
  "#2F4440","#2E3835"
];

// Ring 4: 19 colors
const ring4Colors = [
  "#E68396","#FFD749","#FEF066","#65C3DD","#5DA1E2",
  "#5165B0","#8E6B8C","#C28896","#D39F91","#E9BFA0",
  "#FBC89A","#FFB65C","#FF9842","#FF6940","#F1413E",
  "#CB3746","#9F3454","#813E5C","#664E67"
];

const rings = [
  { colors: ring1Colors, inner: 0, outer: radii[0] },
  { colors: ring2Colors, inner: radii[0], outer: radii[1] },
  { colors: ring3Colors, inner: radii[1], outer: radii[2] },
  { colors: ring4Colors, inner: radii[2], outer: radii[3] }
];

// === DRAW RINGS ===
rings.forEach((ring, idx) => {
  const arc = d3.arc()
      .innerRadius(ring.inner)
      .outerRadius(ring.outer);

  const group = g.append("g")
      .attr("class", `ring ring-${idx+1}`);

  const pie = d3.pie().value(1)(ring.colors);

  group.selectAll("path")
    .data(pie)
    .join("path")
      .attr("d", arc)
      .attr("fill", d => d.data)
      .attr("stroke", "black")
      .attr("stroke-width", 0.5);

  // drag rotation
  let currentAngle = 0;
  const drag = d3.drag()
    .on("drag", (event) => {
      const dx = event.x - width/2;
      const dy = event.y - height/2;
      const angle = Math.atan2(dy, dx) * 180 / Math.PI;
      const delta = angle - currentAngle;
      group.attr("transform", `rotate(${delta})`);
      group.attr("data-angle", delta);
    })
    .on("start", (event) => {
      const dx = event.x - width/2;
      const dy = event.y - height/2;
      currentAngle = Math.atan2(dy, dx) * 180 / Math.PI;
    });
  group.call(drag);
});

// === LABELS + LEADER LINES (right side, stacked) ===
const labelData = [
  { text: "Ring 4", ringIdx: 3, yOffset: -60 },
  { text: "Ring 3", ringIdx: 2, yOffset: -20 },
  { text: "Ring 2", ringIdx: 1, yOffset: 20 },
  { text: "Ring 1", ringIdx: 0, yOffset: 60 }
];

labelData.forEach(ld => {
  const ring = rings[ld.ringIdx];
  const xStart = ring.outer * Math.cos(0);
  const yStart = ring.outer * Math.sin(0);
  const xEnd = width/2 + ring.outer + 100;
  const yEnd = height/2 + ld.yOffset;

  svg.append("line")
    .attr("class", "leader")
    .attr("x1", width/2 + xStart)
    .attr("y1", height/2 + yStart)
    .attr("x2", xEnd - 30)
    .attr("y2", yEnd);

  svg.append("text")
    .attr("class", "label")
    .attr("x", xEnd)
    .attr("y", yEnd)
    .attr("dominant-baseline", "middle")
    .text(ld.text);
});

// === Center label ===
g.append("circle")
  .attr("r", radii[0]/2)
  .attr("fill", "black");
g.append("text")
  .attr("fill", "white")
  .attr("text-anchor", "middle")
  .attr("dominant-baseline", "middle")
  .style("font-size", "20px")
  .text("Tibi");

</script>
</body>
</html>
